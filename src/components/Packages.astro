---
import CataratasImg from '../assets/image/Cards/Brasil/Cataratas.jpg';
import ParqueImg from '../assets/image/Cards/Brasil/Parque das Aves.jpg';
import MacucoImg from '../assets/image/Cards/Brasil/Macuco.webp';
import ComprasImg from '../assets/image/Cards/Paraguai/Compras.jpg';
import CataratasArgImg from '../assets/image/Cards/Argentina/CataratasArg.webp';
import CityTourArgImg from '../assets/image/Cards/Argentina/CityTourArg.webp';
import KatamaramImg from   '../assets/image/Cards/Brasil/Katamaram 2.webp';
import SaltosDelMondayImg from   '../assets/image/Cards/Paraguai/SaltosDelMonday.webp';
import CityTourFozImg from '../assets/image/Cards/Brasil/Marco das Três Fonteiras.webp';

import { ChevronLeft, ChevronRight } from 'lucide-astro';

---
<section id='Packages' class="section-padding section-reveal">
  <div class="relative z-10 p-4 md:p-8">
    <div class="header-container flex justify-between items-center mb-4">
      <h1 class='text-black title-reveal w-full' data-translate="packages.title">Descubra Nossas Experiências</h1>
      
      <div class="carousel-controls flex-shrink-0"> 
        <button class="carousel-btn carousel-btn-prev" id="prevBtn" style="display: none;">
          <ChevronLeft size={20} />
        </button>
        <button class="carousel-btn carousel-btn-next" id="nextBtn">
          <ChevronRight size={20} />
        </button>
      </div>
    </div>
    
    <h2 class='-mt-4 mb-8 w-2/2' data-translate="packages.subtitle">Viva o Melhor de Foz do Iguaçu e região com a BNI Tour...</h2>
    
    <div class="carousel-container">
      <div class="carousel-wrapper">
        <div class="carousel-track" id="carousel-track">
          
          <div class="image-container card-reveal" data-index="0">
            <div class="card-tag card-tag-green" data-translate="packages.card_tag.foz_brasil">Foz do Iguaçu - Brasil</div>
            <img src={ParqueImg.src} alt="Foz do Iguaçu - Brasil">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                 <h1 class="mb-2 w-2/2" data-translate="packages.joias_naturais.titulo">Joias <br> Naturais</h1>
                  <p data-translate="packages.joias_naturais.descricao"> Cataratas do Iguaçu e Parque das Aves. A Força da Natureza...</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>
                </a>
              </div>
            </div>
          </div>
          
          <div class="image-container card-reveal" data-index="1">
            <div class="card-tag card-tag-blue" data-translate="packages.card_tag.puerto_argentina">Puerto Iguazú - Argentina</div>
            <img src={CataratasArgImg.src} alt="Puerto Iguazú - Argentina">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                <h1 class="mb-2 w-full" data-translate="packages.cataratas_argentina.titulo">Cataratas Argentina</h1>
                  <p data-translate="packages.cataratas_argentina.descricao">Marcos das três fronteiras, jantar, vinhoteca, cassino e muito mais...</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>

                </a>
              </div>
            </div>
          </div>
          
          <div class="image-container card-reveal" data-index="2">
            <div class="card-tag card-tag-green" data-translate="packages.card_tag.foz_brasil">Foz do Iguaçu - Brasil</div>
            <img src={MacucoImg.src} alt="Foz do Iguaçu - Brasil">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                 <h1 class="mb-2 w-fill whitespace-nowrap" data-translate="packages.aventura_emocao.titulo">Aventura e <br> Emoção</h1>
                  <p data-translate="packages.aventura_emocao.descricao"> Para os amantes da aventura. Que tal um passeio de barco nas Cataratas?</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>
                </a>
              </div>
            </div>
          </div>
          
          <div class="image-container card-reveal" data-index="3">
            <div class="card-tag card-tag-red" data-translate="packages.card_tag.ciudad_paraguai">Ciudad del Este - Paraguai</div>
            <img src={ComprasImg.src} alt="Ciudad del Este - Paraguai">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                 <h1 class="mb-2" data-translate="packages.compras_cultura.titulo">Compras e Cultura</h1>
                  <p data-translate="packages.compras_cultura.descricao">Explore e compre em Ciudad del Este. Sem preocupações...</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>
                </a>
              </div>
            </div>
          </div>

          <div class="image-container card-reveal" data-index="4">
            <div class="card-tag card-tag-blue" data-translate="packages.card_tag.puerto_argentina">Puerto Iguazú - Argentina</div>
            <img src={CityTourArgImg.src} alt="Puerto Iguazú - Argentina">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                <h1 class="mb-2 w-full" data-translate="packages.city_tour_argentina.titulo">City Tour Argentina</h1>
                  <p data-translate="packages.city_tour_argentina.descricao">Marcos das três fronteiras, jantar, vinhoteca, cassino e muito mais...</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>

                </a>
              </div>
            </div>
          </div>
          
          <div class="image-container card-reveal" data-index="5">
            <div class="card-tag card-tag-green" data-translate="packages.card_tag.foz_brasil">Foz do Iguaçu - Brasil</div>
            <img src={KatamaramImg.src} alt="Foz do Iguaçu - Brasil">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                 <h1 class="mb-2 whitespace-nowrap" data-translate="packages.cruzeiro_por_do_sol.titulo">Cruzeiro ao <br> Pôr do Sol</h1>
                  <p data-translate="packages.cruzeiro_por_do_sol.descricao">Katamarã: Foz do Iguaçu Sob um Novo Olhar...</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>
                </a>
              </div>
            </div>
          </div>
          
          <div class="image-container card-reveal" data-index="6">
            <div class="card-tag card-tag-red" data-translate="packages.card_tag.ciudad_paraguai">Ciudad del Este - Paraguai</div>
            <img src={SaltosDelMondayImg.src} alt="Ciudad del Este - Paraguai">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                 <h1 class="mb-2" data-translate="packages.city_tour_paraguai.titulo">City Tour Paraguai</h1>
                  <p data-translate="packages.city_tour_paraguai.descricao">Lago de Lá Republica, Igreja San Lucas Saltos Monday e muito mais...</p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>
                </a>
              </div>
            </div>
          </div>

          <div class="image-container card-reveal" data-index="7">
            <div class="card-tag card-tag-green" data-translate="packages.card_tag.foz_brasil">Foz do Iguaçu - Brasil</div>
            <img src={CityTourFozImg.src} alt="Foz do Iguaçu - Brasil">
            <div class="absolute inset-0" style="background: linear-gradient(90deg, rgba(0, 0, 0, 0.5), transparent);"></div>
            <div class="card-content relative z-10">
              <div class="card-content-wrapper">
                <div class="card-text">
                 <h1 class="mb-2 whitespace-nowrap" data-translate="packages.city_tour_foz.titulo">City Tour <br> Foz do Iguaçu</h1>
                  <p data-translate="packages.city_tour_foz.descricao">Transfer, Wonder Park, Itaipu, Marco das três fronteiras e muito mais... </p>
                </div>
                <a href='/' class="btn-cta text-white hover:bg-white/10">
                  <span class="button-content-initial-text" data-translate="packages.see_more_button">Ver Mais</span>
                  <div class="btn-cta-icon-wrapper button-content-initial-icon bg-white/20">
                    <ChevronRight size={20} color="white" />
                  </div>
                </a>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</section>

<style>
html, body {
  overflow-x: hidden !important;
  max-width: 100vw !important;
}

@media (max-width: 768px) {
  .header-container {
    position: relative;
    margin-bottom: 120px;
    flex-direction: column;
    align-items: flex-start;
  }
  
  .header-container h1 {
    width: 100% !important;
  }
  
  .header-container + h2 {
    width: 100% !important;
  }
  
  .carousel-controls {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 60px; 
  }
  
  .carousel-container {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    overflow: hidden !important;
  }
  
  .carousel-wrapper {
    width: 100%;
    overflow: hidden !important;
  }
  
  .carousel-track {
    display: flex;
    transition: transform 0.3s ease;
    gap: 0;
  }
  
  .image-container {
    flex: 0 0 100vw;
    width: 100vw;
    padding: 0 20px;
    box-sizing: border-box;
    height: 280px;
    border-radius: 0 !important;
  }
  
  .image-container img {
    border-radius: 0 !important;
  }
}

@media (min-width: 769px) and (max-width: 1023px) {
  .header-container {
    flex-direction: row;
    margin-bottom: 2rem;
  }
  
  .carousel-track {
    gap: 1.5rem;
  }
  
  .image-container {
    width: calc(50% - 0.75rem);
    height: 280px;
  }
}

@media (min-width: 1024px) {
  .header-container {
    flex-direction: row;
    margin-bottom: 2rem;
  }
  
  .carousel-track {
    gap: 1rem;
  }
  
  .image-container {
    width: calc(33.333% - 0.667rem);
    height: 300px;
  }
}
</style>

<script type="text/javascript">
(function() {
  'use strict';
  
  document.addEventListener('DOMContentLoaded', function() {
    var sections = document.querySelectorAll('.section-reveal');
    
    var observer = new IntersectionObserver(function(entries) {
      for (var i = 0; i < entries.length; i++) {
        var entry = entries[i];
        if (entry.isIntersecting) {
          entry.target.classList.add('section-reveal-active');
          
          setTimeout(function() {
            var titles = entry.target.querySelectorAll('.title-reveal');
            for (var j = 0; j < titles.length; j++) {
              setTimeout((function(index, title) {
                return function() { 
                  title.classList.add('is-visible');
                };
              })(j, titles[j]), j * 200); 
            }
          }, 400);
          
          setTimeout(function() {
            var cards = entry.target.querySelectorAll('.card-reveal');
            for (var k = 0; k < cards.length; k++) {
              setTimeout((function(index, card) {
                return function() {
                  card.classList.add('is-visible');
                };
              })(k, cards[k]), k * 200);
            }
          }, 800);
          
          setTimeout(function() {
            var ctaButtons = entry.target.querySelectorAll('.btn-cta');
            for (var l = 0; l < ctaButtons.length; l++) {
              setTimeout((function(index, button) {
                return function() {
                  button.classList.add('is-revealed');
                };
              })(l, ctaButtons[l]), l * 200);
            }
          }, 1200);
        }
      }
    });

    for (var m = 0; m < sections.length; m++) {
      observer.observe(sections[m]);
    }
    
    var track = document.getElementById('carousel-track');
    var prevBtn = document.getElementById('prevBtn');
    var nextBtn = document.getElementById('nextBtn');
    var cards = document.querySelectorAll('.image-container');
    var carouselContainer = document.querySelector('.carousel-container');
    
    if (!track || !prevBtn || !nextBtn || !carouselContainer || cards.length === 0) {
      return;
    }
    
    var currentIndex = 0;
    var autoPlayInterval = null;
    
    function getCardsToShow() {
      if (window.innerWidth <= 768) return 1;
      if (window.innerWidth <= 1023) return 2;
      return 3;
    }
    
    function getMaxIndex() {
      return Math.max(0, cards.length - getCardsToShow());
    }
    
    function updateCarousel() {
      var cardsToShow = getCardsToShow();
      
      if (cardsToShow === 1) {
        track.style.transform = 'translateX(-' + (currentIndex * 100) + 'vw)';
      } else {
        var cardWidth = cards[0].offsetWidth;
        var gap = cardsToShow === 2 ? 24 : 16; 
        var translateX = -(currentIndex * (cardWidth + gap));
        track.style.transform = 'translateX(' + translateX + 'px)';
      }
      
      var maxIndex = getMaxIndex();
      
      prevBtn.style.display = currentIndex === 0 ? 'none' : 'flex';
      nextBtn.style.display = currentIndex >= maxIndex ? 'none' : 'flex';
    }
    
    function goToSlide(index) {
      var maxIndex = getMaxIndex();
      currentIndex = Math.max(0, Math.min(index, maxIndex));
      updateCarousel();
    }
    
    function nextSlide() {
      var maxIndex = getMaxIndex();
      if (currentIndex < maxIndex) {
        goToSlide(currentIndex + 1);
      } else {
        goToSlide(0); 
      }
    }
    
    function prevSlide() {
      if (currentIndex > 0) {
        goToSlide(currentIndex - 1);
      } else {
        goToSlide(getMaxIndex()); 
      }
    }
    
    function startAutoPlay() {
      if (autoPlayInterval !== null) {
        clearInterval(autoPlayInterval);
        autoPlayInterval = null;
      }
      
      autoPlayInterval = setInterval(function() {
        nextSlide();
      }, 4000);
    }
    
    function stopAutoPlay() {
      if (autoPlayInterval !== null) {
        clearInterval(autoPlayInterval);
        autoPlayInterval = null;
      }
    }
    
    function resetAutoPlay() {
      stopAutoPlay();
      startAutoPlay();
    }
    
    prevBtn.addEventListener('click', function(e) {
      e.preventDefault();
      prevSlide();
      resetAutoPlay();
    });
    
    nextBtn.addEventListener('click', function(e) {
      e.preventDefault();
      nextSlide();
      resetAutoPlay();
    });
    
    carouselContainer.addEventListener('mouseenter', function() {
      stopAutoPlay();
    });
    
    carouselContainer.addEventListener('mouseleave', function() {
      startAutoPlay();
    });
    
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        stopAutoPlay();
      } else {
        startAutoPlay();
      }
    });
    
    window.addEventListener('resize', function() {
      var maxIndex = getMaxIndex();
      
      if (currentIndex > maxIndex) {
        currentIndex = maxIndex;
      }
      
      updateCarousel();
      resetAutoPlay();
    });
    
    var touchStartX = 0;
    var touchEndX = 0;
    
    function onTouchStart(e) {
      if (e.touches && e.touches.length > 0) {
        touchStartX = e.touches[0].clientX;
      }
      stopAutoPlay();
    }
    
    function onTouchEnd(e) {
      if (e.changedTouches && e.changedTouches.length > 0) {
        touchEndX = e.changedTouches[0].clientX;
        handleSwipe();
      }
      startAutoPlay();
    }
    
    function handleSwipe() {
      var swipeThreshold = 50;
      var swipeDistance = touchStartX - touchEndX;
      
      if (Math.abs(swipeDistance) > swipeThreshold) {
        if (swipeDistance > 0) {
          nextSlide();
        } else {
          prevSlide();
        }
      }
    }
    
    carouselContainer.addEventListener('touchstart', onTouchStart);
    carouselContainer.addEventListener('touchend', onTouchEnd);
    
    updateCarousel();
    startAutoPlay();
  });
})();
</script>